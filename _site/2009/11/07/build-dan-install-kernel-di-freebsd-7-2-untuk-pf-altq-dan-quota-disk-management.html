<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <title>Build dan Install Kernel di FreeBSD 7.2 untuk PF, ALTQ, dan Quota Disk Management</title>
    <link rel="stylesheet" href="/style.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="/syntax.css" type="text/css" media="screen"/>
</head>

<script type="text/javascript">
        var disqus_awesome = ; 
        var disqus_developer = ;
</script>    

<body>
    <div class="outercolumn">
        <div class="topbar">
            <a href="/index.html">Home</a> - <a href="/archives/index.html">archive</a>
        </div>

        <div class="column">
            <div class="content">
                

<div class="title">
    Build dan Install Kernel di FreeBSD 7.2 untuk PF, ALTQ, dan Quota Disk Management
</div>

<div class="date">
<!--    

    published: 07 Nov 2009,
    in category: <a href="/archives/installbuildFreeBSDKernelPFALTQQuota-Disk.html">installbuildFreeBSDKernelPFALTQQuota-Disk</a>
-->
    in category: 
<a rel="tag" href="/archives/install.html">install</a>, 

<a rel="tag" href="/archives/build.html">build</a>, 

<a rel="tag" href="/archives/FreeBSD.html">FreeBSD</a>, 

<a rel="tag" href="/archives/Kernel.html">Kernel</a>, 

<a rel="tag" href="/archives/PF.html">PF</a>, 

<a rel="tag" href="/archives/ALTQ.html">ALTQ</a>, 

<a rel="tag" href="/archives/Quota-Disk.html">Quota-Disk</a>, 



</div>

<div class="innercontent">
    <p>Sudah lama tak bersua di sini. Sedikit dokumentasi dari saya. Mungkin ini tak berarti bagi anda, tapi mungkin berarti bagi org2 dibelahan bumi yang lain membutuhkan informasi ini. Baik langsung saja:</p>

<h2 id='persiapan_build_dan_install_kernel'>Persiapan build dan install kernel:</h2>

<pre><code># cd /usr/src/sys/i386/conf
# mkdir /root/kernels
# cp GENERIC /root/kernels/MYKERNEL
# ln -s /root/kernels/MYKERNEL</code></pre>

<p>edit konfig kernel</p>

<pre><code># vi MYKERNEL</code></pre>

<h2 id='packet_filter'>packet filter:</h2>

<p>Untuk PF tambahkan di akhir baris <code>MYKERNEL</code> seperti berikut:</p>

<pre><code>device pf
device pflog
device pfsync</code></pre>

<p><code>ALTQ</code> atau alternate queuing of network packets. utility untuk <code>PF</code></p>
<div class='highlight'><pre><code class='bash'><span class='c'># Untuk ALTQ</span>
options         ALTQ
options         ALTQ_CBQ        <span class='c'># Class Bases Queuing (CBQ)</span>
options         ALTQ_RED        <span class='c'># Random Early Detection (RED)</span>
options         ALTQ_RIO        <span class='c'># RED In/Out</span>
options         ALTQ_HFSC       <span class='c'># Hierarchical Packet Scheduler (HFSC)</span>
options         ALTQ_PRIQ       <span class='c'># Priority Queuing (PRIQ)</span>
options         ALTQ_NOPCC      <span class='c'># Required for SMP build</span>
</code></pre>
</div>
<h2 id='untuk_disk_quota_manajemen'>Untuk Disk QUota Manajemen</h2>

<pre><code>options QUOTA</code></pre>

<p>Lalu sekarang build dan install</p>

<pre><code># cd /usr/src/
# make buildkernel KERNCONF=MYKERNEL
# make installkernel KERNCONF=MYKERNEL</code></pre>

<p>selesai&#8230;</p>

<p>konfig <code>rc</code> nya sekarang&#8230;.</p>

<h2 id='configurasi_rcconf'>Configurasi rc.conf</h2>

<p>Untuk PF:</p>
<div class='highlight'><pre><code class='bash'><span class='c'># untuk PF</span>
<span class='nv'>pf_enable</span><span class='o'>=</span><span class='s2'>&quot;YES&quot;</span>;                 <span class='c'># Enable PF (load module if required)</span>
<span class='nv'>pf_rules</span><span class='o'>=</span><span class='s2'>&quot;/etc/pf.conf&amp;quot;         # rules definition file for pf</span>
<span class='s2'>pf_flags=&quot;&quot;;                     # additional flags for pfctl startup</span>
<span class='s2'>pflog_enable=&quot;</span>YES<span class='s2'>&quot;;              # start pflogd(8)</span>
<span class='s2'>pflog_logfile=&quot;</span>/var/log/pflog<span class='s2'>&quot;;  # where pflogd should store the logfile</span>
<span class='s2'>pflog_flags=&quot;&quot;;</span>
<span class='s2'># jika pake LAN dibelakang firewall enable gatewaynya</span>
<span class='s2'>gateway_enable=&quot;</span>YES<span class='s2'>&quot;;</span>
<span class='s2'>ipfilter_enable=&quot;</span>YES<span class='s2'>&quot;;</span>
<span class='s2'>ipnat_enable=&quot;</span>YES<span class='s2'>&quot;;</span>
<span class='s2'>ipmon_enable=&quot;</span>YES<span class='s2'>&quot;;</span>
<span class='s2'>ipfs_enable=&quot;</span>YES<span class='err'>&quot;</span>;
</code></pre>
</div>
<p>Untuk Disk Quota:</p>
<div class='highlight'><pre><code class='bash'><span class='c'># Disk Quota</span>
<span class='nv'>enable_quotas</span><span class='o'>=</span>&amp;quot;YES&amp;quot;
<span class='nv'>check_quotas</span><span class='o'>=</span>&amp;quot;NO&amp;quot;
</code></pre>
</div>
<p>Configurasi <code>/etc/fstab</code> untuk Quota Disk:</p>

<p>contoh:</p>

<pre><code>/dev/ad0s1f             /usr            ufs     rw,userquota,groupquota        22</code></pre>

<p><em>reboot&#8230;.</em></p>

<h2 id='cara_pake'>Cara Pake</h2>

<h2 id='pf'>PF:</h2>

<p>Enable:</p>

<pre><code>pfctl -e</code></pre>

<p>Disable:</p>

<pre><code>pfctl -d</code></pre>

<p>Add</p>

<pre><code>pfctl -t nama_tabel -T add no_ip

[root@share /usr/home/admin]# pfctl -t tendang -T add 192.168.1.34
1 table created.
1/1 addresses added.</code></pre>

<p>2 ip sekaligus</p>

<pre><code>[root@share /usr/home/admin]# pfctl -t tendang -T add 192.168.1.34 192.168.1.33 2/2 addresses added.</code></pre>

<p>del pfctl -t nama_tabel -T delete no_ip</p>

<pre><code>[root@share /usr/home/admin]# pfctl -t tendang -T delete 192.168.1.34 192.168.1.33</code></pre>

<p>2/2 addresses deleted.</p>

<h2 id='disk_quota'>Disk quota</h2>

<p>Aktifkan quota partisi:</p>

<pre><code>quotacheck /usr</code></pre>

<p>jika belum ada quota manajemennya, maka akan membuat file <code>quota.user</code> dan <code>quota.group</code> di <code>/usr</code></p>

<h2 id='manajemen_quota_untuk_user'>Manajemen quota untuk user</h2>

<p>misal: user <code>deanet</code></p>

<pre><code># edquota deanet
Quotas for user deanet:
/usr: kbytes in use: 16982, limits (soft = 17000, hard = 17500)
    inodes in use: 55, limits (soft = 0, hard = 0)</code></pre>

<h2 id='penjelasan'>Penjelasan:</h2>

<p>soft=17000 hard=17500 alokasi tenggang (kbytes) = 500</p>

<p>save lalu cek:</p>

<pre><code>[root@share /usr/home/admin]# quota deanet
Disk quotas for user deanet (uid 1001):
     Filesystem   usage   quota   limit   grace   files   quota   limit   grace
           /usr   16982   17000   17500              55       0       0</code></pre>

<p>lalu skarang test copy file:</p>

<pre><code>[deanet@share ~]$ cp ../admin/Docs/debian-503-i386-netinst.iso .
/usr: warning, user disk quota exceeded
/usr: write failed, user disk limit reached
cp: ./debian-503-i386-netinst.iso: Disc quota exceeded</code></pre>

<p>cek lagi, apa benar quota disk uda jalan:</p>

<pre><code>[deanet@share ~]$ quota
Disk quotas for user deanet (uid 1001):
     Filesystem   usage   quota   limit   grace   files   quota   limit   grace
           /usr   17446*  17000   17500   7days      56       0       0</code></pre>

<p>okeh, it&#8217;s work..</p>

<p>Referensi: <strong>lum ada, linkna lupa.. nyusul..</strong></p>
</div>



<div id="disqus_thread"></div>

<script type="text/javascript" src="http://disqus.com/forums/buildsystem/embed.js">
</script>

<noscript>
    <p> <a href="http://nebansnotebook.disqus.com/?url=ref">View the discussion thread. </a> </p>
</noscript>



<div class="prevnext">
    
        <div class="prev">
            &laquo; <a href="/2009/10/01/installation-and-setting-network-freebsd-virtual-box-on-slackware-host.html"> Installation and setting network FreeBSD Virtual Box on Slackware Host </a>
        </div>
    

    
        <div class="next">
            <a href="/2009/12/01/disable-user-login-on-freebsd.html"> Disable user Login on FreeBSD </a> &raquo;
        </div>
    
</div>




            </div>
            
<div class="footer">
   <center>
	<small>alinux.web.id, established since 2007, hosted by <a target="_new" href="http://tor.hu">tor.hu</a>, powered by <a target="_new" href="http://www.vim.org">vim</a> and <a target="_new" href="http://jekyllrb.com">jekyll</a><br/>
<a target="_new" href="https://github.com/deanet/alinux-documentation">source</a>
</small>
	</center>
</div>

            <div class="pageend"></div>
        </div>
    </div>
</body>
</html>

