<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <title>Clustering Openldap 2.4 dengan Mirror Node Replication di CentOs 5.5</title>
    <link rel="stylesheet" href="/style.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="/syntax.css" type="text/css" media="screen"/>
</head>

<script type="text/javascript">
        var disqus_awesome = ; 
        var disqus_developer = ;
</script>    

<body>
    <div class="outercolumn">
        <div class="topbar">
            <a href="/index.html">Home</a> - <a href="/archives/index.html">archive</a>
        </div>

        <div class="column">
            <div class="content">
                

<div class="title">
    Clustering Openldap 2.4 dengan Mirror Node Replication di CentOs 5.5
</div>

<div class="date">
<!--    

    published: 05 Sep 2010,
    in category: <a href="/archives/clusteringopenldapmirroringreplicatecentos.html">clusteringopenldapmirroringreplicatecentos</a>
-->
    in category: 
<a rel="tag" href="/archives/clustering.html">clustering</a>, 

<a rel="tag" href="/archives/openldap.html">openldap</a>, 

<a rel="tag" href="/archives/mirroring.html">mirroring</a>, 

<a rel="tag" href="/archives/replicate.html">replicate</a>, 

<a rel="tag" href="/archives/centos.html">centos</a>, 



</div>

<div class="innercontent">
    <h2 id='installasi'>Installasi</h2>

<h2 id='barkeley_db_48'>Barkeley DB 4.8</h2>
<div class='highlight'><pre><code class='bash'> <span class='nb'>cd</span> /usr/local/src/
 wget -c http://download.oracle.com/berkeley-db/db-4.8.30.tar.gz
 tar -xzvf db-4.8.30.tar.gz
 <span class='nb'>cd </span>db-4.8.30
 <span class='nb'>cd </span>build_unix
 ../dist/configure --prefix<span class='o'>=</span>/usr/local/BerkeleyDB4.8.30
 make clean
 make
 make install
</code></pre>
</div>
<h3 id='update_ldconfig'>update ldconfig</h3>
<div class='highlight'><pre><code class='bash'> <span class='nv'>CPPFLAGS</span><span class='o'>=</span><span class='s2'>&quot;-I/usr/local/BerkeleyDB4.8.30/include&quot;</span>
 <span class='nb'>export </span>CPPFLAGS
 <span class='nv'>LDFLAGS</span><span class='o'>=</span><span class='s2'>&quot;-L/usr/local/lib -L/usr/local/BerkeleyDB4.8.30/lib -R/usr/local/BerkeleyDB4.8.30/lib&quot;</span>
 <span class='nb'>export </span>LDFLAGS
 <span class='nv'>LD_LIBRARY_PATH</span><span class='o'>=</span><span class='s2'>&quot;/usr/local/BerkeleyDB4.8.30/lib&quot;</span>
 <span class='nb'>export </span>LD_LIBRARY_PATH
</code></pre>
</div>
<h2 id='openldap_24'>openldap 2.4</h2>
<div class='highlight'><pre><code class='bash'> <span class='nb'>cd</span> /usr/local/src/
 wget -c ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/openldap-2.4.23.tgz
 ./configure --prefix<span class='o'>=</span>/usr/local/openldap2.4
 make depend
 make
 make install
</code></pre>
</div>
<h2 id='konfigurasi'>Konfigurasi:</h2>

<p>file conf:</p>
<div class='highlight'><pre><code class='bash'>/usr/local/openldap2.4/etc/openldap/slapd.conf
/usr/local/openldap2.4/etc/openldap/ldap.conf
</code></pre>
</div>
<h2 id='setup_mirror_node'>SETUP MIRROR NODE</h2>

<p><strong>SERVER1/192.168.11.215:</strong></p>
<div class='highlight'><pre><code class='xml'>[user@server1 ~]$ sudo cat /usr/local/openldap2.4/etc/openldap/slapd.conf
#
# See slapd.conf(5) for details on configuration options.
# This file should NOT be world readable.
#
include         /usr/local/openldap2.4/etc/openldap/schema/core.schema
include         /usr/local/openldap2.4/etc/openldap/schema/corba.schema
include         /usr/local/openldap2.4/etc/openldap/schema/cosine.schema
include         /usr/local/openldap2.4/etc/openldap/schema/nis.schema
include         /usr/local/openldap2.4/etc/openldap/schema/inetorgperson.schema

pidfile         /usr/local/openldap2.4/var/run/slapd.pid
argsfile        /usr/local/openldap2.4/var/run/slapd.args

# Load dynamic backend modules:
 modulepath     /usr/local/openldap2.4

#######################################################################
# BDB database definitions
#######################################################################

database        bdb
suffix          &quot;dc=domain-indonesia,dc=com&quot;
rootdn          &quot;cn=admin,dc=domain-indonesia,dc=com&quot;
# Cleartext passwords, especially for the rootdn, should
# be avoid.  See slappasswd(8) and slapd.conf(5) for details.
# Use of strong authentication encouraged.
rootpw          domainldap
# The database directory MUST exist prior to running slapd AND
# should only be accessible by the slapd and slap tools.
# Mode 700 recommended.
directory       /usr/local/openldap2.4/var/openldap-data
# Indices to maintain

index objectClass,entryCSN,entryUUID    eq,pres
index ou,cn,mail,surname,givenname      eq,pres,sub
index uidNumber,gidNumber,loginShell    eq,pres
index uid,memberUid                     eq,pres,sub
index nisMapName,nisMapEntry            eq,pres,sub


overlay syncprov
syncprov-checkpoint 100 10
syncprov-sessionlog 100

# Global section
serverID    1
# database section

# syncrepl directive
syncrepl        rid=001
                provider=ldap://192.168.11.216
                bindmethod=simple
                binddn=&quot;cn=admin,dc=domain-indonesia,dc=com&quot;
                credentials=domainldap
                searchbase=&quot;dc=domain-indonesia,dc=com&quot;
                schemachecking=on
                type=refreshAndPersist
                retry=&quot;60 +&quot;
mirrormode on
[user@server1 ~]$
</code></pre>
</div>
<p><strong>SERVER2/192.168.11.216:</strong></p>
<div class='highlight'><pre><code class='xml'>[user@server2 ~]$ sudo cat /usr/local/openldap2.4/etc/openldap/slapd.conf
#
# See slapd.conf(5) for details on configuration options.
# This file should NOT be world readable.
#
include         /usr/local/openldap2.4/etc/openldap/schema/core.schema
include         /usr/local/openldap2.4/etc/openldap/schema/corba.schema
include         /usr/local/openldap2.4/etc/openldap/schema/cosine.schema
include         /usr/local/openldap2.4/etc/openldap/schema/nis.schema
include         /usr/local/openldap2.4/etc/openldap/schema/inetorgperson.schema

pidfile         /usr/local/openldap2.4/var/run/slapd.pid
argsfile        /usr/local/openldap2.4/var/run/slapd.args

# Load dynamic backend modules:
 modulepath     /usr/local/openldap2.4

#######################################################################
# BDB database definitions
#######################################################################

database        bdb
suffix          &quot;dc=domain-indonesia,dc=com&quot;
rootdn          &quot;cn=admin,dc=domain-indonesia,dc=com&quot;

# Cleartext passwords, especially for the rootdn, should
# be avoid.  See slappasswd(8) and slapd.conf(5) for details.
# Use of strong authentication encouraged.
rootpw          domainldap
# The database directory MUST exist prior to running slapd AND
# should only be accessible by the slapd and slap tools.
# Mode 700 recommended.
directory       /usr/local/openldap2.4/var/openldap-data
# Indices to maintain

index objectClass,entryCSN,entryUUID    eq,pres
index ou,cn,mail,surname,givenname      eq,pres,sub
index uidNumber,gidNumber,loginShell    eq,pres
index uid,memberUid                     eq,pres,sub
index nisMapName,nisMapEntry            eq,pres,sub


overlay syncprov
syncprov-checkpoint 100 10
syncprov-sessionlog 100

# Global section
serverID    2
# database section

# syncrepl directive
syncrepl        rid=001
                provider=ldap://192.168.11.215
                bindmethod=simple
                binddn=&quot;cn=admin,dc=domain-indonesia,dc=com&quot;
                credentials=domainldap
                searchbase=&quot;dc=domain-indonesia,dc=com&quot;
                schemachecking=on
                type=refreshAndPersist
                retry=&quot;60 +&quot;
mirrormode on

[user@server2 ~]$
</code></pre>
</div>
<p>debug:</p>
<div class='highlight'><pre><code class='bash'>sudo /usr/local/openldap2.4/libexec/slapd -h ldap:/// -u ldap -f /usr/local/openldap2.4/etc/openldap/slapd.conf -d -1
</code></pre>
</div>
<p>search:</p>
<div class='highlight'><pre><code class='bash'>sudo /usr/local/openldap2.4/bin/ldapsearch -x
</code></pre>
</div>
<p>add:</p>
<div class='highlight'><pre><code class='bash'>sudo /usr/local/openldap2.4/bin/ldapadd -x -D <span class='s2'>&quot;cn=admin,dc=domain-indonesia,dc=com&quot;</span> -f /home/user/tes2.ldif -W
</code></pre>
</div>
<p>delete:</p>
<div class='highlight'><pre><code class='bash'>sudo /usr/local/openldap2.4/bin/ldapdelete -D <span class='s2'>&quot;cn=admin,dc=domain-indonesia,dc=com&quot;</span> -w domainldap <span class='s2'>&quot;dc=domain-indonesia,dc=com&quot;</span> <span class='s2'>&quot;ou=Barat,dc=domain-indonesia,dc=com&quot;</span>
</code></pre>
</div>
<p>Cara mengujinya dengan mengaktifkan ke dua server dalam keadaan debug mode agar terlihat log errornya, lalu tambahkan data di server1 misalnya, terus cek di server 2 apakah automatis terupdate. Jika sudah terupdate lakukan hal yang sama dengan server 2. Seharusnya ke dua server akan tetap sinkronise jika ditambahkan dari kedua nya.</p>

<p>semoga membantu :)</p>

<p>referensi:</p>

<ol>
<li><a href='http://download.oracle.com/docs/cd/E17076_01/html/installation/build_unix.html'>http://download.oracle.com/docs/cd/E17076_01/html/installation/build_unix.html</a></li>

<li><a href='http://s0t4.blogspot.com/2010/05/instalasi-source-openldap-2421-di.html'>http://s0t4.blogspot.com/2010/05/instalasi-source-openldap-2421-di.html</a></li>

<li><a href='http://lists.arthurdejong.org/openldap-technical/2008/09/msg00011.html'>http://lists.arthurdejong.org/openldap-technical/2008/09/msg00011.html</a></li>

<li><a href='http://www.openldap.org/doc/admin24/replication.html'>http://www.openldap.org/doc/admin24/replication.html</a></li>

<li><a href='http://itsecureadmin.com/wiki/index.php/OpenLDAP_Multi-Master_Replication'>http://itsecureadmin.com/wiki/index.php/OpenLDAP_Multi-Master_Replication</a></li>
</ol>

<p>bacaan menarik: <a href='http://www.centos.org/docs/5/html/CDS/ag/8.0/Managing_Replication-Replication_Scenarios.html'>http://www.centos.org/docs/5/html/CDS/ag/8.0/Managing_Replication-Replication_Scenarios.html</a></p>
</div>



<div id="disqus_thread"></div>

<script type="text/javascript" src="http://disqus.com/forums/buildsystem/embed.js">
</script>

<noscript>
    <p> <a href="http://nebansnotebook.disqus.com/?url=ref">View the discussion thread. </a> </p>
</noscript>



<div class="prevnext">
    
        <div class="prev">
            &laquo; <a href="/2010/07/29/how-to-kill-windows-process-and-integrated-with-nagios-using-nsclient%2B%2B-on-gnu-linux.html"> How to kill windows process and integrated with nagios using Nsclient++ on Gnu/Linux </a>
        </div>
    

    
        <div class="next">
            <a href="/2010/10/04/Make-usb-installer-OpenBSD-4.8.html"> Make USB installer OpenBSD 4.8 </a> &raquo;
        </div>
    
</div>




            </div>
            
<div class="footer">
   <center>
	<small>alinux.web.id, established since 2007, hosted by <a target="_new" href="http://tor.hu">tor.hu</a>, powered by <a target="_new" href="http://www.vim.org">vim</a> and <a target="_new" href="http://jekyllrb.com">jekyll</a><br/>
<a target="_new" href="https://github.com/deanet/alinux-documentation">source</a>
</small>
	</center>
</div>

            <div class="pageend"></div>
        </div>
    </div>
</body>
</html>

